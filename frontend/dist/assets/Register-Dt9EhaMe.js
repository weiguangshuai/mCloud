import{o as x,c as b,a as o,w as s,r as t,u as U,b as f,d as P,e as R,f as u,s as z,E as C,g as E,h as c}from"./index-DtofCPvg.js";import{_ as h,u as q,r as B}from"./_plugin-vue_export-helper-Dn21ojkh.js";const N={class:"login-container"},S={class:"login-footer"},K={__name:"Register",setup(L){const g=U(),_=q(),m=c(null),i=c(!1),r=E({username:"",nickname:"",password:"",confirmPassword:""}),w={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度 3-50 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少 6 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(p,e,a)=>{e!==r.password?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}]};async function d(){if(await m.value.validate().catch(()=>!1)){i.value=!0;try{const e=await B({username:r.username,password:r.password,nickname:r.nickname});z(e.data.token),_.setUser(e.data.user),C.success("注册并登录成功"),g.push("/")}catch{}finally{i.value=!1}}}return(p,e)=>{const a=t("el-input"),n=t("el-form-item"),v=t("el-button"),k=t("el-form"),V=t("router-link"),y=t("el-card");return x(),b("div",N,[o(y,{class:"login-card"},{default:s(()=>[e[7]||(e[7]=f("h2",null,"注册账号",-1)),o(k,{ref_key:"formRef",ref:m,model:r,rules:w,onSubmit:P(d,["prevent"])},{default:s(()=>[o(n,{prop:"username"},{default:s(()=>[o(a,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=l=>r.username=l),"prefix-icon":"User",placeholder:"用户名",size:"large"},null,8,["modelValue"])]),_:1}),o(n,{prop:"nickname"},{default:s(()=>[o(a,{modelValue:r.nickname,"onUpdate:modelValue":e[1]||(e[1]=l=>r.nickname=l),"prefix-icon":"UserFilled",placeholder:"昵称（可选）",size:"large"},null,8,["modelValue"])]),_:1}),o(n,{prop:"password"},{default:s(()=>[o(a,{modelValue:r.password,"onUpdate:modelValue":e[2]||(e[2]=l=>r.password=l),"prefix-icon":"Lock",type:"password",placeholder:"密码",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),o(n,{prop:"confirmPassword"},{default:s(()=>[o(a,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=l=>r.confirmPassword=l),"prefix-icon":"Lock",type:"password",placeholder:"确认密码",size:"large","show-password":"",onKeyup:R(d,["enter"])},null,8,["modelValue"])]),_:1}),o(n,null,{default:s(()=>[o(v,{type:"primary",size:"large",style:{width:"100%"},loading:i.value,onClick:d},{default:s(()=>[...e[4]||(e[4]=[u(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),f("div",S,[e[6]||(e[6]=u(" 已有账号？",-1)),o(V,{to:"/login"},{default:s(()=>[...e[5]||(e[5]=[u("去登录",-1)])]),_:1})])]),_:1})])}}},I=h(K,[["__scopeId","data-v-8edf8d24"]]);export{I as default};
